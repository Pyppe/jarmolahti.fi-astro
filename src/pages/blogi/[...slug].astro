---
import _ from 'lodash'
import { determineSlug } from '../../utils.ts'
import BaseLayout from '../../layouts/BaseLayout.astro'

// https://docs.astro.build/reference/api-reference/
export async function getStaticPaths() {
  const data = await Astro.fetchContent('./posts/*.(md|html)')

  const posts = data.map(post => {
    return {
      params: { slug: determineSlug(post.file.pathname) },
      props: { post }
    }
  })

  return posts
}
const { slug } = Astro.request.params
const { post } = Astro.props;
---

<BaseLayout title={post.title} description={post.description ?? ''} permalink={'TODO'}>

  <div class="prose">
    <h1>{post.title}</h1>
    <div>{post.date}</div>
    {post.astro.html}
  </div>
</BaseLayout>
